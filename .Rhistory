setwd("C:/IS415/Project/geospatial_analytics")
shiny::runApp()
shiny::runApp()
packages = c('ggmap', 'rgdal','qdapTools', 'spatstat', 'readr', 'dplyr', 'sf', 'tmap','tmaptools')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p)
}
library(p,character.only = T)
}
housesfinalv1<- read_csv('data/resale-flat-prices/finalCSVforplots.csv')
houses_grouped_sf <- st_as_sf(housesfinalv1, coords = c("lon", "lat"))
houses_sf <- st_set_crs(houses_sf, 4326)
houses_sf <- st_transform(houses_sf, 3414)
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
mpsz_sf <- st_as_sf(mpsz)
summary(houses_sf)
housesfinalv1<- read_csv('data/resale-flat-prices/finalCSVforplots.csv')
houses_sf <- st_as_sf(housesfinalv1, coords = c("lon", "lat"))
houses_sf <- st_set_crs(houses_sf, 4326)
houses_sf <- st_transform(houses_sf, 3414)
mpsz <- readOGR(dsn='data/mpsz', layer='MP14_SUBZONE_WEB_PL')
mpsz_sf <- st_as_sf(mpsz)
summary(houses_sf)
houses_agg <- houses_sf %>% group_by(REGION_N) %>% summarise(mean_dist=mean(min_dist_clinic))
chart_region <- ggplot(houses_agg,aes(x = reorder(REGION_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment( aes(x=reorder(REGION_N, -mean_dist), xend=REGION_N, y=0, yend=mean_dist), color="#535c68", size=2, alpha=0.7,face="bold") +
geom_point( color="#336e7b", size=5, alpha=1) +
geom_text(nudge_y = 20,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Region for Housing and Development Board Units")
chart_region
#set theme
theme_dotplot <-
theme(axis.title = element_text(family = "Trebuchet MS", color="#666666", face="bold", size=12),
panel.background = element_rect(fill = "#e4e9ed",
size = 0.25, linetype = "solid"),
panel.grid.major = element_line(size = 0.3, linetype = 'solid',
colour = "white"),
panel.grid.minor = element_line(size = 0.3, linetype = 'solid',
colour = "white"),
panel.border = element_blank(),
axis.ticks.y = element_blank())
houses_agg <- houses_sf %>% group_by(REGION_N) %>% summarise(mean_dist=mean(min_dist_clinic))
chart_region <- ggplot(houses_agg,aes(x = reorder(REGION_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment( aes(x=reorder(REGION_N, -mean_dist), xend=REGION_N, y=0, yend=mean_dist), color="#535c68", size=2, alpha=0.7,face="bold") +
geom_point( color="#336e7b", size=5, alpha=1) +
geom_text(nudge_y = 20,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Region for Housing and Development Board Units")
chart_region
houses_agg <- houses_sf %>% group_by(REGION_N) %>% summarise(mean_dist=mean(min_dist_clinic))
chart_region <- ggplot(houses_agg,aes(x = reorder(REGION_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment(aes(x=reorder(REGION_N, -mean_dist), xend=REGION_N, y=0, yend=mean_dist), color=ifelse(houses_agg$REGION_N=="EAST REGION","orange", "#535c68"), size=ifelse(houses_agg$REGION_N=="EAST REGION",3, 2), alpha=0.7,face="bold") +
geom_point( color=ifelse(houses_agg$REGION_N=="EAST REGION","orange","#336e7b"), size=5, alpha=1) +
geom_text(nudge_y = 20,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Region for Housing and Development Board Units")
chart_region
houses_agg <- houses_sf[houses_sf$REGION_N=="CENTRAL REGION", ] %>% group_by(SUBZONE_N) %>% summarise(mean_dist=mean(min_dist_clinic))
chart_subzone <- ggplot(houses_agg,aes(x = reorder(SUBZONE_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment( aes(x=reorder(SUBZONE_N, -mean_dist), xend=SUBZONE_N, y=0, yend=mean_dist), color="#535c68", size=2, alpha=0.7,face="bold") +
geom_point( color="#336e7b", size=5.5, alpha=1) +
geom_text(nudge_x = 0.25,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Subzone for Housing and Development Board Units")
chart_subzone
houses_agg <- houses_sf[houses_sf$REGION_N=="CENTRAL REGION", ] %>% group_by(town) %>% summarise(mean_dist=mean(min_dist_clinic))
chart_pa <- ggplot(houses_agg,aes(x = reorder(town, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment( aes(x=reorder(town, -mean_dist), xend=town, y=0, yend=mean_dist), color="#535c68", size=2, alpha=0.7,face="bold") +
geom_point( color="#336e7b", size=5, alpha=1) +
geom_text(nudge_y = 20,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Planning Area for Housing and Development Board Units")
chart_pa
houses_agg <- houses_sf %>% group_by(SUBZONE_N) %>% summarise(mean_dist=mean(min_dist_clinic))
houses_agg <- houses_agg[order(houses_agg$mean_dist),][c(1:10),]
chart_region <- ggplot(houses_agg,aes(x = reorder(SUBZONE_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment(aes(x=reorder(SUBZONE_N, -mean_dist), xend=SUBZONE_N, y=0, yend=mean_dist), color=ifelse(houses_agg$SUBZONE_N=="BUGIS","orange", "#535c68"), size=ifelse(houses_agg$SUBZONE_N=="BUGIS",3, 2), alpha=0.7,face="bold") +
geom_point(color=ifelse(houses_agg$SUBZONE_N=="BUGIS","orange","#336e7b"), size=5, alpha=1) +
geom_text(nudge_y =10,family = "Trebuchet MS",color="#666666",face="bold") + #reduce  nudge_y if we have less rows (reduced to 10)
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Planning Area for Housing and Development Board Units")
chart_region
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp('app_2.R')
runApp('app_old.R')
runApp()
chart_region <- ggplot(houses_agg,aes(x = reorder(REGION_N, -mean_dist), y=mean_dist, label=round(mean_dist,2))) +
geom_segment( aes(x=reorder(REGION_N, -mean_dist), xend=REGION_N, y=0, yend=mean_dist), color="#535c68", size=2, alpha=0.7,face="bold") +
geom_point( color="#336e7b", size=5, alpha=1) +
geom_text(nudge_y = 20,family = "Trebuchet MS",color="#666666",face="bold") +
coord_flip() +
theme_dotplot +
xlab("Mean for Minimum Distance") +
ylab("Region for Housing and Development Board Units")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mpr <- readOGR(dsn='data/mp_region/MP14_REGION_WEB_PL.kml', layer='MP14_REGION_WEB_PL')
mpa <- readOGR(dsn='data/mp_planning_area/MP14_PLNG_AREA_WEB_PL.kml', layer='MP14_PLNG_AREA_WEB_PL')
View(mpa)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
##Data preparation
busStops_sf <- st_as_sf(busStops, coords=c("lon", "lat"))
busStops <- read_csv('data/busStops/bus-stops.csv')
##Data preparation
busStops_sf <- st_as_sf(busStops, coords=c("lon", "lat"))
View(busStops_sf)
runApp()
spfs <- read_csv('data/singapore-police-force-establishment/spf.csv')
View(busStops)
View(spfs)
gpclinics <- read_csv('data/clinics/clinics.csv')
View(gpclinics)
mrt <- read_csv('data/mrtstation/mrt.csv')
schools <- read_csv('data/schools/schools.csv')
houses <- read_csv('data/resale-flat-prices/finalCSVforplots.csv')
hawkers <- read_csv('data/hawker-centres/hawker-centres.csv')
runApp()
runApp()
gpclinics %>% rename('name' = 'Name')
gpclinics %>% rename('Name' = 'name')
runApp()
'busStop' %in% facilities
facilities <- c('busStop', 'clinics','hawkers','mrt','schools','spf')
'busStop' %in% facilities
'sssbusStop' %in% facilities
runApp()
runApp()
runApp()
yo_input <- "schools"
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[input$test]))
facility_dist_vector <- vector(mode="list", length=6)
names(facility_dist_vector) <- facilities
facility_dist_vector[[1]] <- "min_dist_busStop"
facility_dist_vector[[2]] <- "min_dist_clinic"
facility_dist_vector[[3]] <- "min_dist_hawker"
facility_dist_vector[[4]] <- "min_dist_mrt"
facility_dist_vector[[5]] <- "min_dist_school"
facility_dist_vector[[6]] <- "min_dist_spf"
yo_input <- "schools"
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[input$test]))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[yo_input]))
View(yo)
facility_dist_vector[yo_input]
facility_dist_vector[yo_input][1]
facility_dist_vector[yo_input]$schools[1]
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[yo_input]$schools[1]))
facility_dist_vector[yo_input][1]
facility_dist_vector[yo_input]
yoyo <- facility_dist_vector[yo_input]
View(yoyo)
facility_dist_vector[[5]] <- houses_sf$min_dist_school
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[yo_input]))
yoyo <- facility_dist_vector[yo_input]
yoyo <- facility_dist_vector[yo_input]
yoyo <- unlist(facility_dist_vector[yo_input])
yoyo <- unlist(facility_dist_vector[yo_input]$schools[1])
yoyo <- unlist(facility_dist_vector[yo_input]$schools)
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(facility_dist_vector[yo_input]$schools))
View(yo)
facility_dist_vector[[5]] <- "min_dist_school"
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$paste(unload(facility_dist_vector[yo_input]$schools), collapse=""))
paste(unload(facility_dist_vector[yo_input]$schools), collapse="")
paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")
summarise(mean_dist=houses_sf[paste(unlist(facility_dist_vector[yo_input]$schools), collapse=""))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf[paste(unlist(facility_dist_vector[yo_input]$schools), collapse=""]))
summarise(mean_dist=houses_sf[paste(unlist(facility_dist_vector[yo_input]$schools), collapse=""])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf[paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf[paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")[1]])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")[1])
paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")[1]
unlist(facility_dist_vector[yo_input]$schools)[1]
unlist(facility_dist_vector[yo_input]$schools)[1]
unlist(facility_dist_vector[yo_input]$schools)[1]
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$unlist(facility_dist_vector[yo_input]$schools)[1])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$[[unlist(facility_dist_vector[yo_input]$schools)[1]]])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$[unlist(facility_dist_vector[yo_input]$schools)[1]])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=houses_sf$paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")[1])
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(houses_sf$paste(unlist(facility_dist_vector[yo_input]$schools), collapse="")[1]))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(houses_sf$facility_dist_vector[yo_input]$schools)[1])
houses_sf$facility_dist_vector[yo_input]
facility_dist_vector[yo_input]
facility_dist_vector[yo_input][1]
facility_dist_vector[yo_input]$schools[1]
facility_dist_vector[yo_input]$schools[1]
facility_dist_vector[yo_input][1]
unlist(facility_dist_vector[yo_input][1])
unlist(facility_dist_vector[yo_input])[1]
unlist(facility_dist_vector[yo_input]$schools)[1]
facility_dist_vector[[5]] <- houses_sf$min_dist_school
unlist(facility_dist_vector[yo_input])
facility_dist_vector[[5]] <- "min_dist_school"
facility_dist_vector[[1]] <- min_dist_busStop
summarise(mean_dist=mean(houses_sf$min_dist_school)
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(houses_sf$min_dist_school))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(min_dist_school))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(houses_sf$min_dist_school))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(min_dist_school))
yo <- houses_sf %>% group_by(SUBZONE_N) %>%
summarise(mean_dist=mean(min_dist_school))
runApp()
